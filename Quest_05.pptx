CREATE OR REPLACE TYPE EMPRESA_TYPE AS OBJECT(
    CNPJ            INTEGER,
    NOME_FANTASIA   VARCHAR2(30),
    PAIS            VARCHAR2(25),
    FUNDACAO        DATE
);

CREATE OR REPLACE TYPE FUNCIONARIO_TYPE AS OBJECT(
    CPF         INTEGER,
    NOME        VARCHAR2(30),
    SEXO        CHAR(1),
    NASCIMENTO  DATE,
    EMPRESA REF EMPRESA_TYPE
);

CREATE TABLE EMPRESA_TAB OF EMPRESA_TYPE;

ALTER TABLE EMPRESA_TAB ADD CONSTRAINT PK_CNPJ PRIMARY KEY(CNPJ);

CREATE TABLE FUNCIONARIO_TAB OF FUNCIONARIO_TYPE;

ALTER TABLE FUNCIONARIO_TAB ADD CONSTRAINT PK_CPF PRIMARY KEY(CPF);

ALTER TABLE FUNCIONARIO_TAB ADD CONSTRAINT FK_EMPRESA FOREIGN KEY(empresa) REFERENCES EMPRESA_TAB;

INSERT INTO EMPRESA_TAB VALUES (1230, 'Empresa ltda', 'Brasil', '06/06/1999');

INSERT INTO FUNCIONARIO_TAB VALUES (08277688330, 'Sergin', 'M', '12/12/2000', SELECT REF(e) FROM EMPRESA_TAB e);

ALTER TYPE EMPRESA_TYPE ADD STATIC FUNCTION contaEmpregados(cnpj INTEGER) RETURN INTEGER CASCADE;

CREATE OR REPLACE TYPE BODY EMPRESA_TYPE AS
    STATIC FUNCTION contaEmpregados(cnpj INTEGER) RETURN INTEGER
    IS
    AUX_TOTAL INTEGER;
    BEGIN
        SELECT COUNT(*) INTO AUX_TOTAL FROM FUNCIONARIO_TAB F WHERE F.EMPRESA.CNPJ = cnpj;
        RETURN AUX_TOTAL;
    END;
END;

SELECT e.CNPJ, EMPRESA_TYPE.contaEmpregados(1230) FROM EMPRESA_TAB e;